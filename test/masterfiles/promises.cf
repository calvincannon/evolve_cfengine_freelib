body common control
{
	bundlesequence => { "main", };
   inputs => { "@{cfengine_stdlib.inputs}",
      "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/EFL/evolve_freelib.cf",
      "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/EFL/efl_common.cf"
   };

   debian|redhat::
      package_module => $(package_module_knowledge.platform_default);
}

bundle common cfengine_stdlib
{
  vars:
      "inputs" slist => {
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/paths.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/common.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/commands.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/packages.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/files.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/services.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/processes.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/storage.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/databases.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/monitor.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/guest_environments.cf",
           "lib/$(sys.cf_version_major).$(sys.cf_version_minor)/bundles.cf",
      };
}

bundle agent main
{
   vars:
      "localhost"
         comment => "Used for server arg in copy_from attributes of EFL",
         slist   => { 'localhost' };

	methods:

      "efl init" usebundle => efl_c;

      test_csv::
         "begin efl tests" usebundle => efl_main( 'efl_data/efl_main.csv' );
      test_json::
         "begin efl tests" usebundle => efl_main( 'efl_data/efl_main.json' );

   reports:
      efl_global_slists::
         "efl_global_lists.ntp_servers => [${efl_global_slists.ntp_servers}]";
         "efl_global_lists.name_servers => [${efl_global_slists.name_servers}]";
         "efl_global_lists.web_servers => [${efl_global_slists.web_servers}]";
}
